<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAY</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #c6efd9 0%, #e2f7eb 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }
        header {
            background: #2e7d52;
            color: white;
            padding: 18px 10px 18px 10px;
            text-align: center;
        }
        .header-icon {
            margin-bottom: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 42px;
            filter: drop-shadow(0 4px 12px #ffd70099);
        }
        h1 { font-size: 27px; margin-bottom: 3px; font-weight: bold;}
        .progress-slider-bar {
            width: 100%;
            margin: 15px 0 10px 0;
            padding: 0 7px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            flex-direction: row; /* ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§ */
        }
        .slider-labels { width: 28px; text-align: center; color: #2e7d52; font-weight: bold; }
        .slider {
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            height: 10px;
            background: #e0e0e0;
            border-radius: 7px;
            outline: none;
            position: relative;
            z-index: 1;
            direction: ltr;
        }
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…: ÙŠØ¨Ø¯Ø£ Ø±Ù…Ø§Ø¯ÙŠ ÙˆÙŠÙ…ØªÙ„Ø¦ Ø£Ø®Ø¶Ø± Ù…Ù† Ù…ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± */
        .slider::-webkit-slider-runnable-track {
            height: 10px;
            background: linear-gradient(
                to right,
                #2e7d52 0,
                #2e7d52 var(--progress,0%),
                #e0e0e0 var(--progress,0%),
                #e0e0e0 100%
            );
            border-radius: 7px;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #2e7d52;
            border: 2px solid #fff;
            cursor: pointer;
            box-shadow: 0 2px 8px #aaa;
            margin-top: -6px;
            transition: background 0.2s;
            z-index: 2;
            position: relative;
        }
        .slider:focus { outline: none; }
        .slider::-moz-range-thumb {
            width: 22px; height: 22px;
            border-radius: 50%; background: #2e7d52; cursor: pointer; border: 2px solid #fff;
            box-shadow: 0 2px 8px #aaa;
            transition: background 0.2s;
        }
        .slider::-moz-range-track {
            height: 10px;
            background: linear-gradient(
                to right,
                #2e7d52 0,
                #2e7d52 var(--progress,0%),
                #e0e0e0 var(--progress,0%),
                #e0e0e0 100%
            );
            border-radius: 7px;
        }
        .slider::-ms-fill-lower {
            background: #2e7d52;
            border-radius: 7px;
        }
        .slider::-ms-fill-upper {
            background: #e0e0e0;
            border-radius: 7px;
        }
        .slider:focus::-webkit-slider-thumb { outline: none; }
        .slider::-moz-range-progress {
            background-color: #2e7d52;
            height: 10px;
            border-radius: 7px;
        }
        .slider::-ms-fill-lower { background-color: #2e7d52; }
        .slider::-ms-fill-upper { background-color: #e0e0e0; }
        .slider-labels.left, .slider-labels.right { font-size: 13px; }
        .slider:focus { outline: none; box-shadow: none; }
        .subject-selection { padding: 15px; text-align: center;}
        .selection-container {
            display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin: 10px 0;
        }
        select {
            padding: 8px 12px; border-radius: 7px; border: 2px solid #2e7d52;
            font-size: 14px; width: 100%; max-width: 230px;
        }
        .start-btn {
            padding: 9px 20px; background: #2e7d52; color: white; border: none;
            border-radius: 7px; cursor: pointer; font-size: 14px; font-weight: bold; transition: all 0.3s;
            margin-top: 12px;
        }
        .start-btn:hover {
            background: #1e5e3b; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .exam-section { padding: 12px; display: none;}
        .subject-name {
            text-align: center; font-size: 17px; font-weight: bold; color: #2e7d52;
            margin-bottom: 13px; padding: 7px; background: #e8f5e9; border-radius: 7px;
        }
        .progress-text { text-align: center; font-weight: bold; color: #2e7d52; margin-bottom: 7px; font-size: 13px;}
        .question-container {
            margin-bottom: 18px; padding: 13px 12px 12px 12px; border: 2px solid #ddd;
            border-radius: 8px; background: #f9f9f9; position: relative; min-height: 110px;
            display: flex; flex-direction: column; align-items: stretch;
            transition: border-color 0.3s;
        }
        .question-header-bar {
            display: flex; align-items: center; gap: 9px; margin-bottom: 7px; width:100%;
        }
        .star-btn {
            background: none; border: none;
            font-size: 23px; color: #ccc; cursor: pointer; transition: all 0.3s;
            margin: 0 0 0 8px; padding:0;
            order: 2;
        }
        .star-btn .fa-star {
            text-shadow: 0 2px 5px #ffc10777, 0 1px 2px #fff;
        }
        .star-btn.starred,
        .star-btn.starred .fa-star{
            color: #ffc107 !important;
            text-shadow: 0 2px 5px #c6efd9, 0 1px 2px #fff,0 0 8px #ffc107cc;
        }
        .star-btn:hover { color: #ffc107;}
        .question-text {
            font-size: 15px; color: #2c3e50; font-weight: 500;
            line-height: 1.5; order: 1; flex: 1; padding: 0; margin: 0;
            word-break: break-word;
        }
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-height: 120px;
            margin-bottom: 5px;
        }
        .option {
            padding: 9px;
            background: #f8f8f8;
            border: 2px solid #e0e0e0;
            border-radius: 7px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 13px;
        }
        .option:hover { border-color: #2e7d52; background: #f0f8f1;}
        .correct {
            border-color: #4caf50 !important;
            border-width: 4px !important;
            color: #2c3e50;
            background: #f9f9f9 !important;
        }
        .incorrect {
            border-color: #f44336 !important;
            border-width: 4px !important;
            color: #2c3e50;
            background: #f9f9f9 !important;
        }
        .navigation-bar-fixed-top {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 7px;
            background: #fff;
            z-index: 30;
            padding: 7px 0 7px 0;
            margin: 0 -12px 10px -12px;
            border-bottom: 1px solid #e0e0e0;
        }
        .nav-btn {
            padding: 5px 13px;
            background: #2e7d52;
            color: white;
            border: none;
            border-radius: 7px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            min-width: 54px;
        }
        .nav-btn:disabled { background: #cccccc; cursor: not-allowed;}
        .nav-btn:hover:not(:disabled) {
            background: #1e5e3b; transform: translateY(-2px);
        }
        .show-featured-btn {
            padding: 2px 10px;
            background: #fffbe6;
            color: #d58500;
            border: 1px solid #ffb300;
            border-radius: 7px;
            font-size: 11px;
            cursor: pointer;
            transition: background 0.2s;
            min-width: 0;
            font-weight: 500;
        }
        .show-featured-btn.active {
            background: #ffecb3;
        }
        .show-featured-btn i {
            font-size: 13px;
            margin-left: 3px;
        }
        .home-btn {
            background: none;
            border: none;
            font-size: 1.6rem;
            cursor: pointer;
            padding: 2px 8px;
            color: #2e7d52;
            transition: background 0.2s;
            line-height: 1;
        }
        .home-btn:hover {
            background: #e3f2fd;
            border-radius: 50%;
        }
        .results-section { padding: 25px; text-align: center; display: none;}
        .results-section h2 { color: #2e7d52; margin-bottom: 15px;}
        .score {
            font-size: 36px; font-weight: bold; color: #2e7d52; margin: 16px 0;
        }
        .restart-btn {
            padding: 10px 30px; background: #2e7d52; color: white; border: none;
            border-radius: 7px; cursor: pointer; font-size: 14px; font-weight: bold; transition: all 0.3s;
            margin-top: 22px;
        }
        .restart-btn:hover {
            background: #1e5e3b; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .shake { animation: shake 0.5s;}
        @keyframes shake {
            0% { transform: translateX(0);}
            20% { transform: translateX(-10px);}
            40% { transform: translateX(10px);}
            60% { transform: translateX(-10px);}
            80% { transform: translateX(10px);}
            100% { transform: translateX(0);}
        }
        .column10-info {
            background: #e8f5e9; padding: 13px; border-radius: 7px; margin: 11px 0;
            border-right: 5px solid #2e7d52; font-size: 13px; line-height: 1.6;
        }
        .bottom-back-btn {
            padding: 8px 16px; background: #2e7d52; color: white; border: none; border-radius: 8px;
            cursor: pointer; font-size: 13px; transition: all 0.3s;
            margin: 14px auto; display: block;
        }
        .bottom-back-btn:hover {
            background: #1e5e3b; transform: translateY(-2px);
        }
        .loading {
            text-align: center; padding: 20px; font-size: 15px; color: #2e7d52;
        }
    </style>
</head>
<body>
<audio id="click-audio" src="https://cdn.pixabay.com/audio/2022/11/16/audio_12bfa6f1e1.mp3"></audio>
<div class="container">
    <header>
        <div class="header-icon">
            ğŸ¥‡
        </div>
        <h1>WAY</h1>
    </header>
    <div class="loading" id="loading">
        <i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...
    </div>
    <div class="subject-selection" id="subject-section" style="display: none;">
        <h2>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©:</h2>
        <div class="selection-container">
            <select id="subject-select"></select>
            <div class="column10-info" id="column10-info"></div>
        </div>
        <button class="start-btn" id="start-btn">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
    <div class="exam-section" id="exam-section">
        <div class="subject-name" id="subject-name"></div>
        <div class="progress-text">Ø§Ù„Ø³Ø¤Ø§Ù„ <span id="current-q">1</span> Ù…Ù† <span id="total-qs">0</span></div>
        <div class="progress-slider-bar">
            <div class="slider-labels left"><span>1</span></div>
            <input type="range" min="1" max="10" value="1" class="slider" id="question-slider">
            <div class="slider-labels right"><span id="max-question">10</span></div>
        </div>
        <div class="navigation-bar-fixed-top" id="nav-top-bar">
            <button class="nav-btn" id="prev-btn" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            <button class="nav-btn" id="next-btn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
            <button class="show-featured-btn" id="show-featured-btn" title="Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù…ÙŠØ²Ø©"><i class="fa-regular fa-star"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù…ÙŠØ²Ø©</button>
            <button class="home-btn" id="nav-home-btn" title="Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"><i class="fas fa-home"></i></button>
        </div>
        <div class="question-container" id="question-container">
            <div class="question-header-bar">
                <button class="star-btn" id="star-btn" title="ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø³Ø¤Ø§Ù„">
                    <i class="fa-regular fa-star"></i>
                </button>
                <div class="question-text" id="question-text"></div>
            </div>
            <div class="options-container" id="options-container"></div>
        </div>
        <button class="bottom-back-btn" id="bottom-back-btn" style="display:none">
            <i class="fas fa-home"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
        </button>
    </div>
    <div class="results-section" id="results-section">
        <h2>Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±!</h2>
        <p>Ø¯Ø±Ø¬ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù‡ÙŠ:</p>
        <div class="score" id="score">0/0</div>
        <button class="restart-btn" id="restart-btn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
        <button class="bottom-back-btn" id="results-back-btn">
            <i class="fas fa-home"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
        </button>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const loadingElement = document.getElementById('loading');
    const subjectSection = document.getElementById('subject-section');
    const subjectSelect = document.getElementById('subject-select');
    const column10Info = document.getElementById('column10-info');
    const startBtn = document.getElementById('start-btn');
    const examSection = document.getElementById('exam-section');
    const subjectName = document.getElementById('subject-name');
    const currentQ = document.getElementById('current-q');
    const totalQs = document.getElementById('total-qs');
    const questionSlider = document.getElementById('question-slider');
    const maxQuestion = document.getElementById('max-question');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const showFeaturedBtn = document.getElementById('show-featured-btn');
    const navHomeBtn = document.getElementById('nav-home-btn');
    const questionContainer = document.getElementById('question-container');
    const starBtn = document.getElementById('star-btn');
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const bottomBackBtn = document.getElementById('bottom-back-btn');
    const resultsSection = document.getElementById('results-section');
    const scoreElement = document.getElementById('score');
    const restartBtn = document.getElementById('restart-btn');
    const resultsBackBtn = document.getElementById('results-back-btn');
    const clickAudio = document.getElementById('click-audio');

    let questions = [];
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let starredQuestions = new Set();
    let showOnlyStarred = false;
    let subjectData = {};

    // Ø±Ø§Ø¨Ø· Ù…Ù„Ù Excel Ø§Ù„Ø¬Ø¯ÙŠØ¯
    const excelFileUrl = 'https://webdr-creator.github.io/Excel/MCQ5.xlsx';

    // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Excel
    function loadExcelFile() {
        loadingElement.style.display = 'block';
        subjectSection.style.display = 'none';
        
        fetch(excelFileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                processExcelData(workbook);
            })
            .catch(error => {
                console.error('Error loading Excel file:', error);
                loadingElement.innerHTML = '<p>Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø£Ø³Ø¦Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.</p>';
            });
    }

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª Excel
    function processExcelData(workbook) {
        subjectData = {};
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ (Ø§Ù„Ù…ÙˆØ§Ø¯)
        const sheetNames = workbook.SheetNames;
        
        sheetNames.forEach(sheetName => {
            const worksheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
            
            if (jsonData.length > 0) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†)
                const headers = jsonData[0];
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø©
                let questionCol = -1, option1Col = -1, option2Col = -1, 
                    option3Col = -1, option4Col = -1, answerCol = -1, infoCol = -1;
                
                headers.forEach((header, index) => {
                    if (header && typeof header === 'string') {
                        const headerLower = header.toLowerCase();
                        if (headerLower.includes('Ø³Ø¤Ø§Ù„') || headerLower.includes('question')) {
                            questionCol = index;
                        } else if (headerLower.includes('Ø§Ø®ØªÙŠØ§Ø±') || headerLower.includes('option') || headerLower.includes('Ø®ÙŠØ§Ø±')) {
                            if (option1Col === -1) option1Col = index;
                            else if (option2Col === -1) option2Col = index;
                            else if (option3Col === -1) option3Col = index;
                            else if (option4Col === -1) option4Col = index;
                        } else if (headerLower.includes('Ø¥Ø¬Ø§Ø¨Ø©') || headerLower.includes('answer')) {
                            answerCol = index;
                        } else if (headerLower.includes('Ù…Ø¹Ù„ÙˆÙ…Ø§Øª') || headerLower.includes('info')) {
                            infoCol = index;
                        }
                    }
                });
                
                // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ®Ù…ÙŠÙ†
                if (questionCol === -1) questionCol = 0;
                if (option1Col === -1) option1Col = 1;
                if (option2Col === -1) option2Col = 2;
                if (option3Col === -1) option3Col = 3;
                if (option4Col === -1) option4Col = 4;
                if (answerCol === -1) answerCol = 5;
                if (infoCol === -1) infoCol = headers.length > 6 ? 6 : -1;
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ù† Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙ…Ø§ ÙÙˆÙ‚
                const sheetQuestions = [];
                let sheetInfo = '';
                
                for (let i = 1; i < jsonData.length; i++) {
                    const row = jsonData[i];
                    if (row.length > 0 && row[questionCol]) {
                        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„ØµÙ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                        if (infoCol !== -1 && row[infoCol] && i === 1) {
                            sheetInfo = row[infoCol];
                        }
                        
                        const question = {
                            question: row[questionCol] || '',
                            options: [
                                row[option1Col] || '',
                                row[option2Col] || '',
                                row[option3Col] || '',
                                row[option4Col] || ''
                            ],
                            answer: row[answerCol] ? String(row[answerCol]).charAt(0).toUpperCase() : 'A',
                            info: infoCol !== -1 ? row[infoCol] : ''
                        };
                        sheetQuestions.push(question);
                    }
                }
                
                subjectData[sheetName] = {
                    questions: sheetQuestions,
                    info: sheetInfo
                };
            }
        });
        
        // Ù…Ù„Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯
        fillSubjectSelect();
        
        loadingElement.style.display = 'none';
        subjectSection.style.display = 'block';
    }

    // Ù…Ù„Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ§Ø¯
    function fillSubjectSelect() {
        subjectSelect.innerHTML = '';
        Object.keys(subjectData).forEach(subject => {
            const option = document.createElement('option');
            option.value = subject;
            option.textContent = subject;
            subjectSelect.appendChild(option);
        });
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø§Ø¯Ø©
        updateColumn10Info();
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
    function updateColumn10Info() {
        const selectedSubject = subjectSelect.value;
        if (subjectData[selectedSubject] && subjectData[selectedSubject].info) {
            column10Info.textContent = subjectData[selectedSubject].info;
            column10Info.style.display = 'block';
        } else {
            column10Info.style.display = 'none';
        }
    }

    // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
    startBtn.addEventListener('click', function() {
        const selectedSubject = subjectSelect.value;
        if (subjectData[selectedSubject]) {
            questions = subjectData[selectedSubject].questions;
            if (questions.length > 0) {
                userAnswers = new Array(questions.length).fill(null);
                starredQuestions.clear();
                showOnlyStarred = false;
                
                subjectName.textContent = selectedSubject;
                totalQs.textContent = questions.length;
                maxQuestion.textContent = questions.length;
                questionSlider.max = questions.length;
                
                currentQuestionIndex = 0;
                updateQuestion();
                
                subjectSection.style.display = 'none';
                examSection.style.display = 'block';
            }
        }
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
    function updateQuestion() {
        if (currentQuestionIndex >= 0 && currentQuestionIndex < questions.length) {
            const question = questions[currentQuestionIndex];
            
            currentQ.textContent = currentQuestionIndex + 1;
            questionSlider.value = currentQuestionIndex + 1;
            updateSliderProgress();
            
            questionText.textContent = question.question;
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø²Ø± Ø§Ù„ØªÙ…ÙŠÙŠØ²
            if (starredQuestions.has(currentQuestionIndex)) {
                starBtn.innerHTML = '<i class="fa-solid fa-star"></i>';
                starBtn.classList.add('starred');
            } else {
                starBtn.innerHTML = '<i class="fa-regular fa-star"></i>';
                starBtn.classList.remove('starred');
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            optionsContainer.innerHTML = '';
            const optionLetters = ['A', 'B', 'C', 'D'];
            
            question.options.forEach((option, index) => {
                if (option && option.trim() !== '') {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.textContent = option;
                    optionElement.dataset.option = optionLetters[index];
                    
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¯ Ø£Ø¬Ø§Ø¨ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„
                    if (userAnswers[currentQuestionIndex] === optionLetters[index]) {
                        if (userAnswers[currentQuestionIndex] === question.answer) {
                            optionElement.classList.add('correct');
                        } else {
                            optionElement.classList.add('incorrect');
                            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                            const correctOption = optionsContainer.querySelector(`[data-option="${question.answer}"]`);
                            if (correctOption) {
                                correctOption.classList.add('correct');
                            }
                        }
                    }
                    
                    optionElement.addEventListener('click', () => selectOption(optionLetters[index]));
                    optionsContainer.appendChild(optionElement);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.disabled = currentQuestionIndex === questions.length - 1;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù† ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ÙˆÙ„
            if (currentQuestionIndex === 0) {
                bottomBackBtn.style.display = 'none';
            } else {
                bottomBackBtn.style.display = 'block';
            }
        }
    }

    // ØªØ­Ø¯ÙŠØ« Ù…Ø¸Ù‡Ø± Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
    function updateSliderProgress() {
        const progress = (currentQuestionIndex / (questions.length - 1)) * 100;
        questionSlider.style.setProperty('--progress', progress + '%');
    }

    // Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø©
    function selectOption(option) {
        userAnswers[currentQuestionIndex] = option;
        updateQuestion();
        
        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©
        const currentQuestion = questions[currentQuestionIndex];
        if (option === currentQuestion.answer) {
            playClickSound();
            setTimeout(() => {
                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    updateQuestion();
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„ØŒ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                    showResults();
                }
            }, 1000);
        } else {
            // Ù‡Ø² Ø§Ù„Ø³Ø¤Ø§Ù„ ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©
            questionContainer.classList.add('shake');
            setTimeout(() => {
                questionContainer.classList.remove('shake');
            }, 500);
        }
    }

    // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù†Ù‚Ø±Ø©
    function playClickSound() {
        clickAudio.currentTime = 0;
        clickAudio.play().catch(e => console.log("Audio play failed:", e));
    }

    // ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø³Ø¤Ø§Ù„
    starBtn.addEventListener('click', function() {
        if (starredQuestions.has(currentQuestionIndex)) {
            starredQuestions.delete(currentQuestionIndex);
            starBtn.innerHTML = '<i class="fa-regular fa-star"></i>';
            starBtn.classList.remove('starred');
        } else {
            starredQuestions.add(currentQuestionIndex);
            starBtn.innerHTML = '<i class="fa-solid fa-star"></i>';
            starBtn.classList.add('starred');
            playClickSound();
        }
    });

    // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ù…ÙŠØ²Ø© ÙÙ‚Ø·
    showFeaturedBtn.addEventListener('click', function() {
        showOnlyStarred = !showOnlyStarred;
        
        if (showOnlyStarred) {
            showFeaturedBtn.classList.add('active');
            showFeaturedBtn.innerHTML = '<i class="fa-solid fa-star"></i> Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ù…ÙŠØ²Ø©';
            
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù…ÙŠØ²Ø§Ù‹ØŒ Ù†Ù†ØªÙ‚Ù„ Ù„Ø£ÙˆÙ„ Ø³Ø¤Ø§Ù„ Ù…Ù…ÙŠØ²
            if (starredQuestions.size > 0 && !starredQuestions.has(currentQuestionIndex)) {
                const firstStarred = Math.min(...Array.from(starredQuestions));
                currentQuestionIndex = firstStarred;
                updateQuestion();
            }
        } else {
            showFeaturedBtn.classList.remove('active');
            showFeaturedBtn.innerHTML = '<i class="fa-regular fa-star"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù…ÙŠØ²Ø©';
        }
    });

    // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
    prevBtn.addEventListener('click', function() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            updateQuestion();
        }
    });

    nextBtn.addEventListener('click', function() {
        if (currentQuestionIndex < questions.length - 1) {
            currentQuestionIndex++;
            updateQuestion();
        } else {
            showResults();
        }
    });

    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„ØªÙ†Ù‚Ù„
    questionSlider.addEventListener('input', function() {
        const newIndex = parseInt(questionSlider.value) - 1;
        if (newIndex >= 0 && newIndex < questions.length && newIndex !== currentQuestionIndex) {
            currentQuestionIndex = newIndex;
            updateQuestion();
        }
    });

    // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    function goToHome() {
        subjectSection.style.display = 'block';
        examSection.style.display = 'none';
        resultsSection.style.display = 'none';
    }

    navHomeBtn.addEventListener('click', goToHome);
    bottomBackBtn.addEventListener('click', goToHome);
    resultsBackBtn.addEventListener('click', goToHome);

    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
    restartBtn.addEventListener('click', function() {
        userAnswers = new Array(questions.length).fill(null);
        starredQuestions.clear();
        currentQuestionIndex = 0;
        updateQuestion();
        resultsSection.style.display = 'none';
        examSection.style.display = 'block';
    });

    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    function showResults() {
        let correctCount = 0;
        
        userAnswers.forEach((answer, index) => {
            if (answer === questions[index].answer) {
                correctCount++;
            }
        });
        
        scoreElement.textContent = `${correctCount}/${questions.length}`;
        examSection.style.display = 'none';
        resultsSection.style.display = 'block';
    }

    // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
    subjectSelect.addEventListener('change', updateColumn10Info);

    // Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Excel Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    loadExcelFile();
});
</script>
</body>
</html>
